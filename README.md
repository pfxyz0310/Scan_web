## 📚 網頁自動截圖轉 PDF 工具 (Scan Web - Chrome 接管版)
這是一個 Python 自動化工具，專門用於將特定的網頁內容自動化掃描並備份為 PDF 檔案。

本程式採用 「瀏覽器接管模式 (Remote Debugging)」 運作。與傳統爬蟲不同，您需要先開啟一個特定的 Chrome 視窗並手動登入目標網站，程式會直接連接該視窗進行操作。這種方式完美解決了圖形驗證碼、帳號登入以及動態載入內容的問題。

## ⚠️ 免責聲明

1. **僅供教學研究使用**：本程式旨在研究 Selenium WebDriver 與瀏覽器除錯端口 (Debug Port) 之自動化應用。
2. **請尊重著作權**：下載之檔案僅供個人備份閱讀，請勿公開散布、販售或用於商業用途。
3. **風險自負**：使用者應自行承擔使用本工具所產生的一切法律責任與風險。

---

## ✨ 特色

- **免帳密輸入**：直接使用您已登入的瀏覽器視窗，安全性更高。
- **所見即所得**：只要瀏覽器看得到的頁面，程式就能截圖。
- **自動翻頁**：模擬鍵盤右方向鍵 (→) 進行翻頁，比模擬滑鼠點擊更穩定。
- **自動合併**：截圖完成後自動將所有圖片合併為單一 PDF 檔。

## 🛠️ 環境需求

- **作業系統**：Windows
- **程式語言**：Python 3.10 或更高版本
- **瀏覽器**：Google Chrome

---

## 📦 安裝步驟 (初次使用請看這)

### 1. 準備專案檔案
請確保您的資料夾中包含以下檔案：
- `main.py` (主程式碼)
- `requirements.txt` (套件清單)

### 2. 安裝 Python 套件
開啟終端機 (CMD 或 PowerShell)，切換到資料夾路徑，執行以下指令以安裝必要套件：

pip install -r requirements.txt


*(若沒有 requirements.txt，請直接執行: `pip install selenium PyPDF2 Pillow`)*

### 3. 建立 Chrome 啟動檔 (關鍵步驟！)
在資料夾中**新增一個文字文件**，將其命名為 **`start_chrome.bat`** (副檔名必須是 .bat，不能是 .txt)，並貼上以下內容：

@echo off
echo 正在開啟可被 Python 控制的 Chrome...
echo 請在這個 Chrome 視窗中登入目標網站並打開欲掃描的內容
echo.

set USER_DIR=%~dp0\chrome_profile
"C:\Program Files\Google\Chrome\Application\chrome.exe" --remote-debugging-port=9222 --user-data-dir="%USER_DIR%"

pause


> **注意**：若您的 Chrome 安裝在非預設路徑 (例如 D 槽)，請自行修改上述代碼中的路徑。

---

## 🚀 使用方式 (每次下載的操作流程)

請務必依照以下順序操作，否則程式會抓不到視窗：

### 步驟 1：啟動專用瀏覽器
雙擊 start_chrome.bat。

### 步驟 2：準備網頁內容
1. 在該 Chrome 視窗中，打開您要掃描的網頁。
2. 確認內容已載入，並移至 起始頁面。
3. 【重要】請用滑鼠點擊一下網頁內容正中央，確保瀏覽器取得「焦點 (Focus)」。

### 步驟 3：執行程式
回到資料夾，在空白處右鍵開啟終端機 (或 CMD)，執行主程式：

python main.py


### 步驟 4：開始下載
1. 程式會顯示 `✅ 成功連接到 Chrome！` 並自動鎖定您的分頁。
2. 依照提示輸入 **總頁數** (例如：300)。
3. 程式開始自動截圖並翻頁。
   - **注意**：執行期間您可以把 Chrome 視窗拉到背景，但 **絕對不能最小化** (不能按視窗右上角的 `_` 縮到工作列)，否則截圖會變全黑。
4. 完成後，程式會自動將圖片合併，產生 `result.pdf`。

---

## 🔧 常見問題排除 (Troubleshooting)

| 問題狀況 | 可能原因 | 解決方法 |
| :--- | :--- | :--- |
| **程式顯示「連接失敗」** | Python 找不到開啟了 Debug Port 的 Chrome | 請確認您一定是透過 `start_chrome.bat` 來開啟瀏覽器，而不是直接點 Chrome 圖示。 |
| **只有截圖沒有翻頁** | 瀏覽器沒有「Focus (焦點)」 | 在執行 Python 程式前，務必用滑鼠**點一下Chrome 頁面中央**。 |
| **截圖出來是全黑或全白** | Chrome 被最小化了 | Chrome 為了省資源，最小化時不會繪製畫面。請保持視窗開啟 (可以被其他視窗擋住，但不能最小化)。 |
| **翻頁速度太慢或太快** | 網路速度影響 | 用記事本開啟 `main.py`，修改開頭的 `WAIT_TIME` 數值 (預設 2.5 秒)。 |
| **找不到 `start_chrome.bat`** | 副檔名隱藏問題 | 請確認您的檔案是 `.bat` 結尾，而不是 `.bat.txt`。 |

## 📂 檔案結構說明

Project/ 
├── main.py # 主程式 (核心邏輯) 
├── start_chrome.bat # 啟動 Debug 模式 Chrome 的腳本 (需自行建立) 
├── requirements.txt # Python 套件需求清單 
├── pdf/ # (自動生成) 暫存截圖的資料夾 
└── result.pdf # (自動生成) 最終合併完成的pdf